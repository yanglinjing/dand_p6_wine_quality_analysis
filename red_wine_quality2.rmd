# Red Wine Quality Analysis
# Which chemical properties influence the quality of red wines?

## Introduction
The tidy data set contains 1,599 red wines with 11 variables on the chemical properties of the wine. At least 3 wine experts rated the quality of each wine, providing a rating between 0 (very bad) and 10 (very excellent).

+ 1599 records
+ 11 chemical properties
+ quality rating: 0 - 10


## Exploration of Data

```{r}
install.packages('ggridges')
```


### Load libraries
```{r}
library(GGally, ggplot2)
library(gridExtra)
library(RColorBrewer)
library(dplyr)
library(memisc) #Linear Regression: mtable
```

### Load data
```{r}
getwd()
list.files()
df <- read.csv('wineQualityReds.csv')
head(df)
```

```{r}
str(df)
```
### Scatterplot Matrixes

```{r}
theme_set(theme_minimal(20))

set.seed(1000)
df_s <- df[, (2:13)]
names(df_s)

ggpairs(df_s[sample.int(nrow(df_s), 1000),])
```

### Quality

```{r}
table(df$quality)
```
```{r}
summary(df$quality)
```

```{r}
ggplot(aes(x=quality, y = ..count..), data =df) +
  geom_histogram()+
  scale_x_continuous(limits = c(0,10),
                     breaks = seq(0, 10,1))
```

### fixed.acidity
```{r}
summary(df$fixed.acidity)
```
#### fixed_acidity: frequent polygone
```{r}
ggplot(aes(x=fixed.acidity), data =df) +
  geom_freqpoly()+
  scale_x_continuous(limits = c(4,16),
                     breaks = seq(4, 16, 1))
```
#### fixed_acidity: log10, sqrt
```{r}
fixed_acidity_p1 <- ggplot(aes(x=fixed.acidity), data= df) + geom_histogram()
fixed_acidity_p2 <- fixed_acidity_p1 + scale_x_log10()
fixed_acidity_p3 <- fixed_acidity_p1 + scale_x_sqrt()

grid.arrange(fixed_acidity_p1, fixed_acidity_p2, fixed_acidity_p3, ncol=1)

```

#### fixed.acidity(log10) & Quality
```{r}
ggplot(aes(x=fixed.acidity, y=quality),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous(trans="log10",
                     limits = c(6,13),
                     breaks = seq(6,13,1))+
  scale_y_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=2, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```
#### fixed.acidity & Quality: Correlation (0.1140837)
```{r}
with(df,cor.test(fixed.acidity, quality, method = "spearman"))
```


### volatile.acidity
```{r}
summary(df$volatile.acidity)
```

#### volatile.acidity: frequent polygone
```{r}
ggplot(aes(x=volatile.acidity), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(0, 1.6, 0.2))
```
#### volatile.acidity: log10, sqrt
```{r}
volatile.acidity_p1 <- ggplot(aes(x=volatile.acidity), data= df) + geom_histogram()
volatile.acidity_p2 <- volatile.acidity_p1 + scale_x_log10()
volatile.acidity_p3 <- volatile.acidity_p1 + scale_x_sqrt()

grid.arrange(volatile.acidity_p1, volatile.acidity_p2, volatile.acidity_p3, ncol=1)
```


#### volatile.acidity & quality
```{r}
ggplot(aes(x=volatile.acidity, y=quality),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous(limits = c(0.1,1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### volatile.acidity & quality: correlation (-0.3806465 < -0.3)
```{r}
with(df, cor.test(volatile.acidity, quality, method = "spearman"))
```

### citric.acid
```{r}
summary(df$citric.acid)
```

#### citric.acid: frequent polygone
```{r}
ggplot(aes(x=citric.acid), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(0, 1, 0.1))
```
#### citric.acid: log10, sqrt
```{r}
citric.acid_p1 <- ggplot(aes(x=citric.acid), data= df) + geom_histogram()
citric.acid_p2 <- citric.acid_p1 + scale_x_log10()
citric.acid_p3 <- citric.acid_p1 + scale_x_sqrt()

grid.arrange(citric.acid_p1, citric.acid_p2, citric.acid_p3, ncol=1)
```


#### citric.acid(sqrt) & quality
```{r}
ggplot(aes(x= citric.acid, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(trans='sqrt',
                     limits = c(0.1, 0.9))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### citric.acid & quality: correlation (0.2134809)
```{r}
with(df, cor.test(citric.acid, quality, method = "spearman"))
```
```{r}
with(
  subset(df, citric.acid>0),cor.test(citric.acid, quality, method = "spearman"))
```

### residual.sugar
```{r}
summary(df$residual.sugar)
```

#### residual.sugar: frequent polygone
```{r}
ggplot(aes(x=residual.sugar), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(0, 15, 1))
```
#### citric.acid: log10, sqrt
```{r}
residual.sugar_p1 <- ggplot(aes(x=residual.sugar), data= df) + geom_histogram()
residual.sugar_p2 <- residual.sugar_p1 + scale_x_log10()
residual.sugar_p3 <- residual.sugar_p1 + scale_x_sqrt()

grid.arrange(residual.sugar_p1, residual.sugar_p2, residual.sugar_p3, ncol=1)
```


#### residual.sugar & quality
```{r}
ggplot(aes(x=residual.sugar, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(limits = c(1,4))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### residual.sugar & quality: correlation (0.03204817)
```{r}
with(df, cor.test(residual.sugar, quality, method = "spearman"))
```
```{r}
with(
  subset(df, residual.sugar<4),cor.test(residual.sugar, quality, method = "spearman"))
```

### chlorides (Cl)
```{r}
summary(df$chlorides)
```

#### chlorides: frequent polygone
```{r}
ggplot(aes(x=chlorides), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(0, 0.65, 0.1))
```
#### citric.acid: log10, sqrt
```{r}
chlorides_p1 <- ggplot(aes(x=chlorides), data= df) + geom_histogram()
chlorides_p2 <- chlorides_p1 + scale_x_log10()
chlorides_p3 <- chlorides_p1 + scale_x_sqrt()

grid.arrange(chlorides_p1, chlorides_p2, chlorides_p3, ncol=1)
```


#### chlorides(log10) & quality
```{r}
ggplot(aes(x=chlorides, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(trans = 'log10', 
                     limits = c(0.05, 0.13),
                     breaks=seq(0.05, 0.13, 0.05))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### residual.sugar & quality: correlation (-0.1899223)
```{r}
with(df, cor.test(chlorides, quality, method = "spearman"))
```
```{r}
with(
  subset(df, chlorides<0.15),cor.test(chlorides, quality, method = "spearman"))
```
### free.sulfur.dioxide
```{r}
summary(df$free.sulfur.dioxide)
```

#### free.sulfur.dioxide: frequent polygone
```{r}
ggplot(aes(x=free.sulfur.dioxide), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(1, 72, 10))
```
#### free.sulfur.dioxide: log10, sqrt
```{r}
free.sulfur.dioxide_p1 <- ggplot(aes(x=free.sulfur.dioxide), data= df) + geom_histogram()
free.sulfur.dioxide_p2 <- free.sulfur.dioxide_p1 + scale_x_log10()
free.sulfur.dioxide_p3 <- free.sulfur.dioxide_p1 + scale_x_sqrt()

grid.arrange(free.sulfur.dioxide_p1, free.sulfur.dioxide_p2, free.sulfur.dioxide_p3, ncol=1)
```


#### free.sulfur.dioxide(log10) & quality
```{r}
ggplot(aes(x=free.sulfur.dioxide, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(trans = 'log10')+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### free.sulfur.dioxide & quality: correlation (-0.05690065)
```{r}
with(df, cor.test(free.sulfur.dioxide, quality, method = "spearman"))
```

### total.sulfur.dioxide
```{r}
summary(df$total.sulfur.dioxide)
```

#### total.sulfur.dioxide: frequent polygone
```{r}
ggplot(aes(x=total.sulfur.dioxide), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(6, 289, 50))
```
#### total.sulfur.dioxide: log10, sqrt
```{r}
total.sulfur.dioxide_p1 <- ggplot(aes(x=total.sulfur.dioxide), data= df) + geom_histogram()
total.sulfur.dioxide_p2 <- total.sulfur.dioxide_p1 + scale_x_log10()
total.sulfur.dioxide_p3 <- total.sulfur.dioxide_p1 + scale_x_sqrt()

grid.arrange(total.sulfur.dioxide_p1, total.sulfur.dioxide_p2, total.sulfur.dioxide_p3, ncol=1)
```


#### total.sulfur.dioxide(log10) & quality
```{r}
ggplot(aes(x=total.sulfur.dioxide, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(trans = 'log10')+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### total.sulfur.dioxide & quality: correlation (-0.1967351)
```{r}
with(df, cor.test(total.sulfur.dioxide, quality, method = "spearman"))
```

### density
```{r}
summary(df$density)
```

#### density: frequent polygone
```{r}
ggplot(aes(x=density), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(0.9, 1.1, 0.1))
```

#### density & quality
```{r}
ggplot(aes(x=density, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(limits = c(0.995, 1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### density & quality: correlation (-0.1770741)
```{r}
with(df, cor.test(density, quality, method = "spearman"))
```

### pH
```{r}
summary(df$pH)
```

#### pH: frequent polygone
```{r}
ggplot(aes(x=pH), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(2.7, 4.1, 0.5))
```

#### pH & quality
```{r}
ggplot(aes(x=pH, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(limits = c(2.7, 4.1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### pH & quality: correlation (-0.04367193 )
```{r}
with(df, cor.test(pH, quality, method = "spearman"))
```
```{r}
with(subset(df, pH >2.7 & pH <3.7),
     cor.test(pH, quality, method = "spearman"))
```


### sulphates (SO4)
```{r}
summary(df$sulphates)
```

#### sulphates: frequent polygone
```{r}
ggplot(aes(x=sulphates), data =df) +
  geom_freqpoly()+
  scale_x_continuous(breaks = seq(0.3, 2, 0.5))
```

#### sulphates: log10, sqrt
```{r}
sulphates_p1 <- ggplot(aes(x=sulphates), data= df) + geom_histogram()
sulphates_p2 <- sulphates_p1 + scale_x_log10()
sulphates_p3 <- sulphates_p1 + scale_x_sqrt()

grid.arrange(sulphates_p1, sulphates_p2, sulphates_p3, ncol=1)
```

#### sulphates(log10) & quality
```{r}
ggplot(aes(x=sulphates, y=quality),data=df)+
  geom_point(alpha = 0.1, size = 1, position = 'jitter')+
  scale_x_continuous(trans='log10',
                     limits = c(0.4, 1.0),
                     breaks = seq(0.4, 1.0, 0.1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### sulphates & quality: correlation (0.3770602 > 0.3)
```{r}
with(df, cor.test(sulphates, quality, method = "spearman"))
```

### alcohol
```{r}
summary(df$alcohol)
```
#### alcohol: frequent polygone
```{r}
ggplot(aes(x=alcohol), data =df) +
  geom_freqpoly()+
  scale_x_continuous(limits = c(8,15),
                     breaks = seq(8, 15, 1))
```
#### alcohol: log10, sqrt
```{r}
alcohol_p1 <- ggplot(aes(x=alcohol), data= df) + geom_histogram()
alcohol_p2 <- alcohol_p1 + scale_x_log10()
alcohol_p3 <- alcohol_p1 + scale_x_sqrt()

grid.arrange(alcohol_p1, alcohol_p2, alcohol_p3, ncol=1)

```

#### alcohol(sqrt) & quality
```{r}
ggplot(aes(x=alcohol, y=quality),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous(trans="sqrt",
                     limits = c(9, 13),
                     breaks = seq(9, 13, 0.5))+
  scale_y_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```
#### alcohol & quality: correlation (0.4785317 >0.3)
```{r}
with(df, cor.test(alcohol, quality, method = "spearman"))
```
```{r}
with(
  subset(df, alcohol>9, alcohol<13),
  cor.test(alcohol, quality, method = "spearman")
)
```

### Explore the 3 variables significantly correlated with quality

3 chemicals are correlated with quality:

+ volatile.acidity: negative
+ sulphates: positive
+ alcohol: positive


#### alcohol & sulphates
```{r}
ggplot(aes(x=alcohol, y=sulphates),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_y_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```
#### alcohol & sulphates: correlation (0.1356407)
```{r}
with(df, cor.test(sqrt(alcohol), log10(sulphates)))
```

#### alcohol, sulphates & quality

```{r}
#group df by alcohol

# add a new variable for grouping
df$alcohol.joint <-
  cut(df$alcohol, c(8.4,9.2,9.5,10,10.5,11,12,14.9))

# check the new variable
table(df$alcohol.joint, useNA = 'ifany')

```


```{r}
ggplot(aes(x=sulphates, y=quality, color = alcohol.joint),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "alcohol", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(trans='log10',
                     limits = c(0.4, 1.0),
                     breaks = seq(0.4, 1.0, 0.1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### alcohol & volatile.acidity
```{r}
ggplot(aes(x=alcohol, y=volatile.acidity),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_y_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```
#### alcohol & volatile.acidity: correlation (-0.2019826 )
```{r}
with(df, cor.test(sqrt(alcohol), volatile.acidity))
```
#### alcohol, volatile.acidity & quality
```{r}
ggplot(aes(x=volatile.acidity, y=quality, color = alcohol.joint),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "alcohol", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(limits = c(0.1,1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### Regression
```{r Building the Linear Model}
m1 <- lm(I(quality) ~ I(sqrt(alcohol)), data = df)
m2 <- update(m1, ~ . + log10(sulphates))
m3 <- update(m2, ~ . + volatile.acidity)

mtable(m1, m2, m3)
```


### pH, fixed.acidity & density

#### fixed.acidity & density
```{r}
ggplot(aes(x=fixed.acidity, y=density),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous(trans="log10")+
  scale_y_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=2, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```


#### fixed.acidity & density: Correlation (0.6680473 > 0.5)
```{r}
with(df,cor.test(fixed.acidity, density))
```

#### fixed.acidity & pH
```{r}
ggplot(aes(x=fixed.acidity, y=pH),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous(trans="log10")+
  scale_y_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=2, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```


#### fixed.acidity & pH: Correlation (-0.6829782 > 0.5)
```{r}
with(df,cor.test(fixed.acidity, pH))
```


#### density & pH
```{r}
ggplot(aes(x=density, y=pH),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous(limits = c(0.993, 1.002))+
  geom_line(stat='summary', fun.y=mean, linetype=2, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### density & pH: Correlation (-0.3416993 < -0.3)
```{r}
with(df,cor.test(density, pH))
```

#### pH, fixed.acidity & density: plot1 (grouping fixed acidity)

```{r}
summary(df$fixed.acidity)
```

```{r}
#group df by fixed.acidity

# add a new variable for grouping
df$fixed.acidity.joint <-
  cut(df$fixed.acidity, c(4.60, 7.10, 7.90, 9.20, 15.90))

# check the new variable
table(df$fixed.acidity.joint, useNA = 'ifany')

```

```{r}
# Without mean/ median lines
ggplot(aes(x=density, y=pH, color = fixed.acidity.joint),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "fixed.acidity", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(limits = c(0.994, 1.002))
```
Fixed Acidity rises, when density increases and pH decreases.
Fixed Acidity drops, when density decreases and pH increases.


```{r}
# With mean/ median lines
ggplot(aes(x=density, y=pH, color = fixed.acidity.joint),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "fixed.acidity", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(limits = c(0.994, 1.002))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

```{r}
ggplot(
  aes(x=density, y=pH), data=subset(df, !is.na(fixed.acidity.joint))
)+
  geom_smooth(
    aes(color=fixed.acidity.joint),
    stat='summary',
    fun.y=mean
  )
```


### pH, fixed.acidity & density: plot2 (grouping pH Values)

```{r}
summary(df$pH)
```

```{r}
#group df by fixed.acidity

# add a new variable for grouping
df$ph.joint <-
  cut(df$pH, c(2.740, 3.210, 3.310, 3.400, 4.010))

# check the new variable
table(df$ph.joint, useNA = 'ifany')

```

```{r}
# Without mean/ median lines
ggplot(aes(x=fixed.acidity, y=density, color = ph.joint),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "pH Values", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous() +
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')
```



### density, alcohol, quality

#### density & alcohol
```{r}
ggplot(aes(x=alcohol, y=density),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_x_continuous()+
  geom_line(stat='summary', fun.y=mean, linetype=2, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')
```

#### density & alcohol: Correlation (-0.4961798  < -0.3)
```{r}
with(df,cor.test(density, alcohol))
```

#### density, alcohol, quality
```{r}
# With mean/ median lines
ggplot(aes(x=density, y=quality, color = alcohol.joint),data=df)+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "alcohol", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous()

```


```{r}
#group df by alcohol

df$alcohol.half <-
  cut(df$alcohol,
      c(8.40, 10.20, 14.90))

table(df$alcohol.half,
      useNA = 'ifany')
```

```{r}
ggplot(aes(density, quality), data=subset(df, !is.na(alcohol.half)))+
  geom_line(aes(color=alcohol.half),
            stat='summary',
            fun.y=mean)
```

#### density & alcohol interaction vs quality: Correlation (0.4772388  > 0.3)
```{r}
with(df,cor.test(density*alcohol, quality))
```



## Final Plots and Summary

3 chemicals are correlated with quality:

+ volatile.acidity: negative
+ sulphates: positive
+ alcohol: positive

### The relationship between alcohol, sulphates and quality

#### Plot:
```{r}
ggplot(aes(x=sulphates, y=quality, color = alcohol.joint),data=subset(df, !is.na(alcohol.joint)))+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "Alcohol", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(trans='log10',
                     limits = c(0.4, 1.0),
                     breaks = seq(0.4, 1.0, 0.1))+
  scale_y_continuous(breaks = seq(3,8,1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')+
  ggtitle('Quality vs\nSulphates(log10) and Alcohol')+ 
  xlab("Sulphates(log10)") + 
  ylab("Quality")+
  theme(plot.title = element_text(size = 20, colour = "#333333"),  
        axis.title.x = element_text(size = 15, colour = "#0e3b82"),  
        axis.title.y = element_text(size = 15, colour = "#0e3b82"),
        legend.title = element_text(size = 15, colour = "#0e3b82"),
        legend.text = element_text(size = 12, colour = "#666666"))
```

#### Findings:
+ Alcohol and quality are positively correlated.

+ Sulphates and quality are positively correlated.


###  The relationship between alcohol, volatile acidity and quality

#### Plot:
```{r}
ggplot(aes(x=volatile.acidity, y=quality, color = alcohol.joint),data=subset(df, !is.na(alcohol.joint)))+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "Alcohol", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(limits = c(0.1 ,1))+
  scale_y_continuous(breaks = seq(3,8,1))+
  geom_line(stat='summary', fun.y=mean, linetype=1, color='red')+
  geom_line(stat='summary', fun.y=quantile, fun.args=list(probs=.5),linetype=1, color='green')+
  ggtitle('Quality v.s.\nVolatile Acidity & Alcohol')+ 
  xlab("Volatile Acidity") + 
  ylab("Quality")+
  theme(plot.title = element_text(size = 20, colour = "#333333"),  
        axis.title.x = element_text(size = 15, colour = "#0e3b82"),  
        axis.title.y = element_text(size = 15, colour = "#0e3b82"),
        legend.title = element_text(size = 15, colour = "#0e3b82"),
        legend.text = element_text(size = 12, colour = "#666666"))

```

#### Findings:
+ Alcohol and quality are positively correlated.

+ Volatile acidity and quality are negatively correlated.

### PH, Fixed Acidity & Density

#### Plot:
```{r}
ggplot(aes(x=density, y=pH, color = fixed.acidity.joint),data=subset(df, !is.na(fixed.acidity.joint)))+
  geom_point(alpha = 0.5, size = 1, position = 'jitter')+
  scale_color_brewer(type = 'div',
                     guide = guide_legend(title = "Fixed Acidity", 
                                          reverse = TRUE,
                                          override.aes = list(alpha = 1, size = 2)))+
  scale_x_continuous(limits = c(0.992, 1.002))+
  ggtitle('PH Value v.s.\nDensity & Fixed Acidity')+ 
  xlab("Density") + 
  ylab("PH Value")+
  theme(plot.title = element_text(size = 20, colour = "#333333"),  
        axis.title.x = element_text(size = 15, colour = "#0e3b82"),  
        axis.title.y = element_text(size = 15, colour = "#0e3b82"),
        legend.title = element_text(size = 15, colour = "#0e3b82"),
        legend.text = element_text(size = 12, colour = "#666666"))
```

#### Findings:
+ Density and pH values are negatively correlated.

+ Fixed acidity and pH values are negatively correlated.

+ Fixed acidity and density values are positively correlated.


## Reflection

### Difficulties
There are too many variables. It takes very long time to explore the relationship between each 2 chemicals and the quality score.

Some of the chemicals are at least moderately correlated with others.

### Successes
I chose the chemicals that are significantly correlated with quality. After checking the relationship between them (not correlated), I explored the relationship between quality and them.


### Additional data and analyses
The quality scores are mainly between 5-6, and some are 7. Besides, none of the wines were scored 0-2 and 9-10. A 5-point scale would be better for scoring. 

Besides, it would be helpful to ask experts to score the acidity and sweetness after tasting (e.g 1-Not sweet at all ~ 5-Too sweet).



```{r}
ggplot(aes(x = fixed.acidity, y = quality.group, fill = quality.group), 
       data= df_quality) +
  geom_density_ridges(scale = 0.8, size = 0.25, rel_min_height = 0.03) +
  theme_ridges() + 
  theme(legend.position = "none")
```
